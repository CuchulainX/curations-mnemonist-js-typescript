<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<style>*{box-sizing:border-box}body{font-family:system-ui,sans-serif;margin:0}</style>
<meta name='generator' content='mdx-deck'>
<title data-head="true">FOSDEM 2019 - Developing data structures for JavaScript</title><link href="https://fonts.googleapis.com/css?family=Muli:900" rel="stylesheet" data-head="true"/><style data-styled-components="jDCqyd kmKUJZ gKaMTo zIEGn CQhxV fxbReE byfFmt cVxceg kPOGYN gsyCmg RNNXF kztYHz eIIwaK hQYcg iLvMQI gmKbQu ccSRck bQMXUX ihLfci hmXDXQ gaOIFD hhoFSc fQmsFW fJODMz CAuLq hLseSp cXgiMa eCoqJu gNzbUH jQkfWF hOCGEu fbxTAJ bNhvRs">
/* sc-component-id: sc-bdVaJa */
.sc-bdVaJa {} .eCoqJu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:8px;margin-left:auto;margin-right:auto;} @media print{.eCoqJu{display:none;}}
/* sc-component-id: sc-bwzfXH */
.sc-bwzfXH {} .gNzbUH{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:4px solid transparent;background-clip:padding-box;border-radius:9999px;width:8px;height:8px;color:inherit;opacity:0.5;margin:0px;padding:4px;color:#363636;background-color:#363636;} .gNzbUH:focus{outline:none;box-shadow:0 0 0 1px;}.jQkfWF{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:4px solid transparent;background-clip:padding-box;border-radius:9999px;width:8px;height:8px;color:inherit;opacity:0.125;margin:0px;padding:4px;color:#363636;background-color:#363636;} .jQkfWF:focus{outline:none;box-shadow:0 0 0 1px;}
/* sc-component-id: sc-htpNat */
.sc-htpNat {} .cXgiMa{position:fixed;left:0;right:0;bottom:0;}
/* sc-component-id: sc-bxivhb */
.sc-bxivhb {} .fbxTAJ{cursor:pointer;width:64px;height:100vh;}
/* sc-component-id: sc-ifAKCX */
.sc-ifAKCX {} .hOCGEu{position:fixed;top:0;left:0;bottom:0;}
/* sc-component-id: sc-EHOje */
.sc-EHOje {} .bNhvRs{position:fixed;top:0;right:0;bottom:0;}
/* sc-component-id: sc-bZQynM */
.sc-bZQynM {} .kmKUJZ{overflow-x:hidden;width:100%;height:100%;} @media print{.kmKUJZ{height:auto;overflow-x:visible;}}
/* sc-component-id: sc-gzVnrw */
.sc-gzVnrw {} .gKaMTo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;height:100%;-webkit-transition-property:-webkit-transform;-webkit-transition-property:transform;transition-property:transform;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;-webkit-transition-duration:.3s;transition-duration:.3s;-webkit-transform:translate3d(0%,0,0);-ms-transform:translate3d(0%,0,0);transform:translate3d(0%,0,0);} @media print{.gKaMTo{height:auto;display:block;}}
/* sc-component-id: sc-htoDjs */
.sc-htoDjs {} .zIEGn{-webkit-flex:none;-ms-flex:none;flex:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;width:100%;height:100%;padding-left:32px;padding-right:32px;} @media print{.zIEGn{width:100vw;height:100vh;page-break-after:always;page-break-inside:avoid;-webkit-print-color-adjust:exact;}} @media screen and (min-width:40em){.zIEGn{padding-left:64px;padding-right:64px;}} @media screen and (min-width:52em){.zIEGn{padding-left:128px;padding-right:128px;}}
/* sc-component-id: sc-dnqmqq */
.sc-dnqmqq {} .jDCqyd{font-family:Bitter,sans-serif;text-align:left;font-size:16px;width:100vw;height:100vh;color:#363636;background-color:F5F5F5;} @media print{.jDCqyd{font-size:24px;height:auto;}} @media screen and (min-width:64em){.jDCqyd{font-size:32px;}} .jDCqyd .Slide > div{min-width:80vw;min-height:60vh;} .jDCqyd strong,.jDCqyd .affix{color:#C65146;} .jDCqyd blockquote > p{font-style:italic;} .jDCqyd pre{padding:0.5em !important;line-height:normal !important;} .jDCqyd pre > code{font-size:0.8em;line-height:normal !important;} .jDCqyd .very-small{font-size:0.5em;}
/* sc-component-id: sc-jzJRlG */
.sc-jzJRlG {} .hLseSp{line-height:1.25;font-size:3em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-cSHVUG */
.sc-cSHVUG {}
/* sc-component-id: sc-kAzzGY */
.sc-kAzzGY {} .cVxceg{line-height:1.25;font-size:2em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-chPdSV */
.sc-chPdSV {}
/* sc-component-id: sc-kgoBCf */
.sc-kgoBCf {} .hQYcg{line-height:1.25;font-size:1.5em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-kGXeez */
.sc-kGXeez {}
/* sc-component-id: sc-kEYyzF */
.sc-kEYyzF {} .RNNXF{color:#C65146;}
/* sc-component-id: sc-kkGfuU */
.sc-kkGfuU {} .kPOGYN{font-size:1.5em;}
/* sc-component-id: sc-iAyFgw */
.sc-iAyFgw {} .iLvMQI{text-align:left;font-size:1.5em;text-align:left;}
/* sc-component-id: sc-hSdWYo */
.sc-hSdWYo {} .fJODMz{text-align:left;font-size:1.5em;text-align:left;}
/* sc-component-id: sc-eHgmQL */
.sc-eHgmQL {}
/* sc-component-id: sc-cvbbAY */
.sc-cvbbAY {} .kztYHz{text-align:left;font-weight:bold;font-size:1.5em;margin-left:0px;margin-right:0px;padding-left:0px;padding-right:0px;color:quote;}
/* sc-component-id: sc-brqgnP */
.sc-brqgnP {} .gsyCmg{font-family:Menlo,monospace;color:#C65146;background-color:#f5f5f5;}
/* sc-component-id: sc-cMljjf */
.sc-cMljjf {} .hhoFSc{max-width:100%;height:auto;object-fit:cover;}
/* sc-component-id: WideLayout__Root-sc-16prk5t-0 */
.WideLayout__Root-sc-16prk5t-0 {} .ihLfci{width:80%;}
/* sc-component-id: WideLayout__OtherRoot-sc-16prk5t-1 */
.WideLayout__OtherRoot-sc-16prk5t-1 {} .fQmsFW{width:80%;font-size:0.8em;}
/* sc-component-id: sc-gipzik */
.sc-gipzik {} .fxbReE{line-height:1.25;font-size:3em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-csuQGl */
.sc-csuQGl {}
/* sc-component-id: sc-Rmtcm */
.sc-Rmtcm {} .bQMXUX{line-height:1.25;font-size:2em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-bRBYWo */
.sc-bRBYWo {}
/* sc-component-id: sc-hzDkRC */
.sc-hzDkRC {} .gaOIFD{line-height:1.25;font-size:1.5em;margin-bottom:16px;margin-top:16px;color:heading;font-weight:900;font-family:Muli,sans-serif;}
/* sc-component-id: sc-jhAzac */
.sc-jhAzac {}</style>
</head>
<body>
<div id=root><div><div class="sc-dnqmqq jDCqyd" mode="NORMAL" step="0" width="100vw" height="100vh" color="text"><link href="https://fonts.googleapis.com/css?family=Bitter" rel="stylesheet"/><div class="sc-bZQynM kmKUJZ"><div class="sc-gzVnrw gKaMTo"><div class="sc-htoDjs zIEGn"><div><h1 class="sc-csuQGl CQhxV sc-gipzik fxbReE" style="text-decoration:underline" font-size="4" color="heading">Developing<br/>data structures<br/>for JavaScript</h1><small>JavaScript devroom, FOSDEM 2019, Brussels</small></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-chPdSV byfFmt sc-kAzzGY cVxceg" font-size="3" color="heading">Why and how to implement efficient data structures to use with node.js or in the browser?</h2></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-chPdSV byfFmt sc-kAzzGY cVxceg" font-size="3" color="heading">Who am I?</h2><p class="sc-kkGfuU kPOGYN" font-size="2"><em>Guillaume Plique</em></p><p class="sc-kkGfuU kPOGYN" font-size="2">alias <code class="sc-brqgnP gsyCmg" color="code">Yomguithereal</code> on both <a class="sc-kEYyzF RNNXF" href="https://github.com/Yomguithereal" color="link">Github</a> an <a class="sc-kEYyzF RNNXF" href="https://twitter.com/Yomguithereal" color="link">Twitter</a>.</p><p class="sc-kkGfuU kPOGYN" font-size="2">Research engineer working for Sciences Po&#x27;s <a class="sc-kEYyzF RNNXF" href="https://medialab.sciencespo.fr" color="link">médialab</a>.</p></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-chPdSV byfFmt sc-kAzzGY cVxceg" font-size="3" color="heading">What&#x27;s a data structure?</h2></div></div><div class="sc-htoDjs zIEGn"><div><blockquote class="sc-cvbbAY kztYHz" font-size="2" color="quote"><p class="sc-kkGfuU kPOGYN" font-size="2">«Web development is not real development and is henceforth easier.»</p></blockquote><div style="text-align:right"><small>Someone wrong on the Internet.</small></div></div></div><div class="sc-htoDjs zIEGn"><div><blockquote class="sc-cvbbAY kztYHz" font-size="2" color="quote"><p class="sc-kkGfuU kPOGYN" font-size="2">«Web development is trivial and web developers don&#x27;t need fancy data structures or any solid knowledge in algorithmics.»</p></blockquote><div style="text-align:right"><small>Someone still wrong (and pedant) on the Internet.</small></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-kGXeez eIIwaK sc-kgoBCf hQYcg" font-size="2" color="heading">Don&#x27;t we already have fully satisfying data structures in JavaScript?</h3><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu"><code class="sc-brqgnP gsyCmg" color="code">Array</code> ➡ lists of things</li><li class="sc-eHgmQL gmKbQu"><code class="sc-brqgnP gsyCmg" color="code">Object</code> ➡ key-value associations</li><li class="sc-eHgmQL gmKbQu"><code class="sc-brqgnP gsyCmg" color="code">Map</code> and <code class="sc-brqgnP gsyCmg" color="code">Set</code> with ES6</li></ul></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-kGXeez eIIwaK sc-kgoBCf hQYcg" font-size="2" color="heading">Why would we want other data structures in JavaScript?</h3></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" style="text-decoration:underline" font-size="3" color="heading">Developing<br/>data structures<br/>for really any high-level interpreted language but definitely with a tight focus on JavaScript</h2><small>JavaScript devroom, FOSDEM 2019, Brussels</small></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">1.</span> <!-- -->Why?</h2></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">1.1.</span> <!-- -->Convenience and bookkeeping</h2></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.1.1.</span> <!-- -->A MultiSet</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// How about changing this:</span>
<span class="token" style="color:#cc7832">const</span> counts <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#cc7832">for</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">const</span> item <span class="token" style="color:#cc7832">in</span> something<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">!</span><span class="token" style="color:#a9b7c6">(</span>item <span class="token" style="color:#cc7832">in</span> counts<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">)</span>
    counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>

  counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">++</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Into this:</span>
<span class="token" style="color:#cc7832">const</span> counts <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">MultiSet</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#cc7832">for</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">const</span> item <span class="token" style="color:#cc7832">in</span> something<span class="token" style="color:#a9b7c6">)</span>
  counts<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">add</span><span class="token" style="color:#a9b7c6">(</span>item<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// And what about this?</span>
<span class="token" style="color:#cc7832">const</span> counts <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#cc7832">for</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">const</span> item <span class="token" style="color:#cc7832">in</span> something<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">!</span><span class="token" style="color:#a9b7c6">(</span>item<span class="token" style="color:#a9b7c6">.</span>key <span class="token" style="color:#cc7832">in</span> counts<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">)</span>
    counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">.</span>key<span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>

  counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">.</span>key<span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">+=</span> item<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#808080">// But value CAN be negative</span>
  <span class="token" style="color:#808080">// and you don&#x27;t want to keep items &lt; 0</span>
  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">.</span>key<span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">&lt;</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#cc7832">delete</span> counts<span class="token" style="color:#a9b7c6">[</span>item<span class="token" style="color:#a9b7c6">.</span>key<span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Still this:</span>
<span class="token" style="color:#cc7832">const</span> counts <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">MultiSet</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#cc7832">for</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">const</span> item <span class="token" style="color:#cc7832">in</span> something<span class="token" style="color:#a9b7c6">)</span>
  counts<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">add</span><span class="token" style="color:#a9b7c6">(</span>item<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.1.2.</span> <!-- -->Complex structures: a Graph</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Sure, you can &quot;implement&quot; graphs using only <code class="sc-brqgnP gsyCmg" color="code">Array</code> and <code class="sc-brqgnP gsyCmg" color="code">Object</code>™.</p><p class="sc-kkGfuU kPOGYN" font-size="2">But:</p><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu">Lots of bookkeeping (multi-way indexation)</li><li class="sc-eHgmQL gmKbQu">Wouldn&#x27;t it be nice to have a legible interface?</li></ul></div></div><div class="sc-htoDjs zIEGn"><div><p class="sc-kkGfuU kPOGYN" font-size="2">Examples taken from the <a class="sc-kEYyzF RNNXF" href="https://graphology.github.io/" color="link">graphology</a> library:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#cc7832">const</span> graph <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Graph</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#808080">// Finding specific neighbors</span>
<span class="token" style="color:#cc7832">const</span> neighbors <span class="token" style="color:#a9b7c6">=</span> graph<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">outNeighbors</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#808080">// Iterating over a node&#x27;s edges</span>
graph<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">forEachEdge</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#a9b7c6">(</span>edge<span class="token" style="color:#a9b7c6">,</span> attributes<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">=&gt;</span> <span class="token" style="color:#a9b7c6">{</span>
  console<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">log</span><span class="token" style="color:#a9b7c6">(</span>attributes<span class="token" style="color:#a9b7c6">.</span>weight<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">1.2.</span> <!-- -->Sometimes Arrays and Objects are not enough</h2></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.2.1.</span> <!-- -->The QuadTree</h3><img class="sc-cMljjf hhoFSc" src="./img/quad.svg" alt="Quad"/></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.2.1.</span> <!-- -->The QuadTree</h3><img class="sc-cMljjf hhoFSc" src="./img/quadtree.svg" alt="QuadTree"/></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.2.2.</span> <!-- -->JavaScript became more than just tacky website candy</h3><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu">We process data on the client nowadays.</li><li class="sc-eHgmQL gmKbQu">Node.js became a thing.</li><li class="sc-eHgmQL gmKbQu">Some algorithms cannot be efficiently implemented without custom data structures (Dijkstra or Inverted Index for full text search etc.).</li></ul></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">1.3.</span> <!-- -->Immutable data structures</h2><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu">Not <em>yet</em> in JavaScript.</li><li class="sc-eHgmQL gmKbQu">Not covered by this talk.</li><li class="sc-eHgmQL gmKbQu">Check out <a class="sc-kEYyzF RNNXF" href="https://github.com/swannodette/mori" color="link">mori</a> and <a class="sc-kEYyzF RNNXF" href="https://facebook.github.io/immutable-js/" color="link">immutable-js</a>.</li></ul></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">2.</span> <!-- -->What are the challenges?</h2></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">1.</span> <!-- -->Interpreted languages are far from the metal</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">2.</span> <!-- -->No control over memory layout &amp; garbage collection</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.</span> <!-- -->JIT and optimizing engines such as Gecko and V8</h3></div></div><div class="sc-htoDjs zIEGn"><div><p class="sc-kkGfuU kPOGYN" font-size="2">TL,DR:<br/>Benchmarking code accurately is <strong>not</strong> easy.</p></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">3.</span> <!-- -->Implementation tips</h2><p class="sc-kkGfuU kPOGYN" font-size="2">It does not mean we cannot be clever about it.</p></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.</span> <!-- -->Time &amp; memory performance</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.1.</span> <!-- -->Minimizing lookups</h3><p class="sc-kkGfuU kPOGYN" font-size="2">&quot;Hashmap&quot; lookups are costly.</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// You made 2 lookups</span>
Graph<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">getNodeAttribute</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">,</span> data<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>_nodes<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">has</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#cc7832">throw</span> <span class="token" style="color:#ffc66d">Error</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">...</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#cc7832">const</span> data <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>_nodes<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#cc7832">get</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#cc7832">return</span> data<span class="token" style="color:#a9b7c6">[</span>name<span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// You made only one</span>
Graph<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">getNodeAttribute</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">,</span> data<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">const</span> data <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>_nodes<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#cc7832">get</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">typeof</span> data <span class="token" style="color:#a9b7c6">===</span> <span class="token" style="color:#6a8759">&#x27;undefined&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#cc7832">throw</span> <span class="token" style="color:#ffc66d">Error</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">...</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#cc7832">return</span> data<span class="token" style="color:#a9b7c6">[</span>name<span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.2.</span> <!-- -->Creating objects is costly</h3><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu">Avoid allocating objects.</li><li class="sc-eHgmQL gmKbQu">Avoid creating regexes.</li><li class="sc-eHgmQL gmKbQu">Functions are even worse.</li></ul><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// BAD!</span>
<span class="token" style="color:#cc7832">const</span> <span class="token,function-variable" style="color:#ffc66d">test</span> <span class="token" style="color:#a9b7c6">=</span> x <span class="token" style="color:#a9b7c6">=&gt;</span> <span class="token" style="background:#364135">/regex/</span><span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">test</span><span class="token" style="color:#a9b7c6">(</span>x<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#808080">// GOOD!</span>
<span class="token" style="color:#cc7832">const</span> <span class="token" style="color:#9876aa">REGEX</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="background:#364135">/regex/</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#cc7832">const</span> <span class="token,function-variable" style="color:#ffc66d">test</span> <span class="token" style="color:#a9b7c6">=</span> x <span class="token" style="color:#a9b7c6">=&gt;</span> <span class="token" style="color:#9876aa">REGEX</span><span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">test</span><span class="token" style="color:#a9b7c6">(</span>x<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.3.</span> <!-- -->Mixing types is bad</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Why do you do that?</span>
<span class="token" style="color:#cc7832">const</span> array <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6897bb">1</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;two&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6897bb">3</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="background:#364135">/four/</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.4.</span> <!-- -->The poor man&#x27;s malloc</h3><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu">Bytes array are fan-ta-stic.</li><li class="sc-eHgmQL gmKbQu">You can simulate typed allocation: <code class="sc-brqgnP gsyCmg" color="code">Uint8Array</code>, <code class="sc-brqgnP gsyCmg" color="code">Float32Array</code> etc.</li><li class="sc-eHgmQL gmKbQu">Use this to implement your own pointer system!</li></ul></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">A linked list (with pointers):
------------------------------
head -&gt; (a) -&gt; (b) -&gt; (c) -&gt; ø
</code></pre><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Using object references as pointers</span>
<span class="token" style="color:#cc7832">function</span> <span class="token" style="color:#ffc66d">LinkedListItem</span><span class="token" style="color:#a9b7c6">(</span>value<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>left <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>right <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">null</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>value <span class="token" style="color:#a9b7c6">=</span> value<span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">A linked list (rolling our own pointers):
-----------------------------------------
head     = 0
values   = [a, b, c]
next     = [1, 2, 0]
</code></pre><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Using Byte Arrays</span>
<span class="token" style="color:#cc7832">function</span> <span class="token" style="color:#ffc66d">LinkedList</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>head <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>next <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Uint16Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>values <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix"></span> <!-- -->A most efficient LRUCache</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#cc7832">class</span> <span class="token,class-name">LRUCache</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#ffc66d">constructor</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>capacity <span class="token" style="color:#a9b7c6">=</span> capacity<span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>forwardPointers <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Uint32Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>backwardPointers <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Unit32Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>keys <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>values <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">new</span> <span class="token,class-name">Array</span><span class="token" style="color:#a9b7c6">(</span>capacity<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>items <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">{</span><span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>size <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>head <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>tail <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#a9b7c6">}</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.4.</span> <!-- -->Function calls are costly</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Everything is costly. Really.</p><p class="sc-kkGfuU kPOGYN" font-size="2">This means that rolling your own stack will always beat recursion.</p></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Recursive version</span>
<span class="token" style="color:#cc7832">function</span> <span class="token" style="color:#ffc66d">recurse</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">,</span> key<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>key <span class="token" style="color:#a9b7c6">&lt;</span> node<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
    <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>left<span class="token" style="color:#a9b7c6">)</span>
      <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#ffc66d">recurse</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>left<span class="token" style="color:#a9b7c6">,</span> key<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#cc7832">false</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#a9b7c6">}</span>
  <span class="token" style="color:#cc7832">else</span> <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>key <span class="token" style="color:#a9b7c6">&gt;</span> node<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
    <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>right<span class="token" style="color:#a9b7c6">)</span>
      <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#ffc66d">recurse</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>right<span class="token" style="color:#a9b7c6">,</span> key<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#cc7832">false</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#a9b7c6">}</span>

  <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#cc7832">true</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__OtherRoot-sc-16prk5t-1 fQmsFW"><div><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Iterative version</span>
<span class="token" style="color:#cc7832">function</span> <span class="token" style="color:#ffc66d">iterative</span><span class="token" style="color:#a9b7c6">(</span>root<span class="token" style="color:#a9b7c6">,</span> key<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">const</span> stack <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">[</span>root<span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">;</span>

  <span class="token" style="color:#cc7832">while</span> <span class="token" style="color:#a9b7c6">(</span>stack<span class="token" style="color:#a9b7c6">.</span>length<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
    <span class="token" style="color:#cc7832">const</span> node <span class="token" style="color:#a9b7c6">=</span> stack<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">pop</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

    <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>key <span class="token" style="color:#a9b7c6">&lt;</span> node<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
      <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>left<span class="token" style="color:#a9b7c6">)</span>
        stack<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">push</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>left<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
      <span class="token" style="color:#cc7832">else</span>
        <span class="token" style="color:#cc7832">break</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#a9b7c6">}</span>
    <span class="token" style="color:#cc7832">else</span> <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>key <span class="token" style="color:#a9b7c6">&gt;</span> node<span class="token" style="color:#a9b7c6">.</span>value<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
      <span class="token" style="color:#cc7832">if</span> <span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>right<span class="token" style="color:#a9b7c6">)</span>
        stack<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">push</span><span class="token" style="color:#a9b7c6">(</span>node<span class="token" style="color:#a9b7c6">.</span>right<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
      <span class="token" style="color:#cc7832">else</span>
        <span class="token" style="color:#cc7832">break</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#a9b7c6">}</span>

    <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#cc7832">true</span><span class="token" style="color:#a9b7c6">;</span>
  <span class="token" style="color:#a9b7c6">}</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.5.</span> <!-- -->Algorithmics vs. the real world</h3><p class="sc-kkGfuU kPOGYN" font-size="2">A better big O is not necessary better in the real world.</p><p class="sc-kkGfuU kPOGYN" font-size="2">Dijkstra requires a Fibonacci heap, but in JavaScript, a binomial heap will often win.</p></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.6.</span> <!-- -->What about wasm etc. ?</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Lots of shiny options:</p><ol class="sc-hSdWYo fJODMz" font-size="2"><li class="sc-eHgmQL gmKbQu">asm.js</li><li class="sc-eHgmQL gmKbQu">WebAssembly</li><li class="sc-eHgmQL gmKbQu">Native code binding in Node.js</li></ol></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.1.6.</span> <!-- -->What about wasm etc. ?</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Communication between those and JavaScript has a cost that negates the benefit.</p><p class="sc-kkGfuU kPOGYN" font-size="2">This is only viable if you have long running code or don&#x27;t need the bridge between the layer and JavaScript.</p></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.</span> <!-- -->Respecting the ecosystem</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.1.</span> <!-- -->Naming matters</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Yes <code class="sc-brqgnP gsyCmg" color="code">#.unshift</code> is a terrible name. <small class="very-small">I am still grateful we avoided smooshing arrays.</small></p><p class="sc-kkGfuU kPOGYN" font-size="2">But consistency is always a plus.</p></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.1.</span> <!-- -->Implement well-known interfaces</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Handling JSON serialization</span>
Structure<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">toJSON</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#cc7832">this</span><span class="token" style="color:#a9b7c6">.</span>items<span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#9876aa">JSON</span><span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">stringify</span><span class="token" style="color:#a9b7c6">(</span>structure<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">&gt;&gt;&gt;</span> <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;something&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;easily&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;serializable&#x27;</span><span class="token" style="color:#a9b7c6">]</span>

Structure<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">toString</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">return</span> somethingUsefulForOnce<span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.2.</span> <!-- -->Make structure iterables</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Implement #.forEach &quot;iterators&quot;</span>
queue<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">forEach</span><span class="token" style="color:#a9b7c6">(</span>item <span class="token" style="color:#a9b7c6">=&gt;</span> console<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">log</span><span class="token" style="color:#a9b7c6">(</span>item<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#808080">// Implement the iterator protocol</span>
Queue<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">values</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>

  <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#a9b7c6">{</span>
    next<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
      <span class="token" style="color:#808080">// ...</span>
      <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#a9b7c6">{</span>
        done<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#cc7832">false</span><span class="token" style="color:#a9b7c6">,</span>
        value<span class="token" style="color:#a9b7c6">:</span> whatever
      <span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
    <span class="token" style="color:#a9b7c6">}</span>
  <span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div class="WideLayout__Root-sc-16prk5t-0 ihLfci"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.2.</span> <!-- -->Make structure iterables</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Make objects iterable</span>
Queue<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">[</span>Symbol<span class="token" style="color:#a9b7c6">.</span>iterator<span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> Queue<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span>values<span class="token" style="color:#a9b7c6">;</span>

<span class="token" style="color:#808080">// Behold the future!</span>
<span class="token" style="color:#cc7832">for</span> <span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#cc7832">const</span> item <span class="token" style="color:#cc7832">of</span> queue<span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  console<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">log</span><span class="token" style="color:#a9b7c6">(</span>item<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">3.2.3.</span> <!-- -->Custom Node.js inspection</h3><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#808080">// Earlier (now Symbol.for(&#x27;nodejs.util.inspect.custom&#x27;))</span>
Queue<span class="token" style="color:#a9b7c6">.</span>prototype<span class="token" style="color:#a9b7c6">.</span><span class="token,function-variable" style="color:#ffc66d">inspect</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#cc7832">function</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span> <span class="token" style="color:#a9b7c6">{</span>
  <span class="token" style="color:#cc7832">return</span> somethingUseful<span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">}</span><span class="token" style="color:#a9b7c6">;</span>

console<span class="token" style="color:#a9b7c6">.</span><span class="token" style="color:#ffc66d">log</span><span class="token" style="color:#a9b7c6">(</span>queue<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">;</span>
<span class="token" style="color:#a9b7c6">&gt;&gt;&gt;</span> Queue <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6897bb">1</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6897bb">2</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6897bb">3</span><span class="token" style="color:#a9b7c6">]</span>

<span class="token" style="color:#808080">// Rather than:</span>
<span class="token" style="color:#a9b7c6">&gt;&gt;&gt;</span> <span class="token" style="color:#a9b7c6">{</span>
  size<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6897bb">1</span><span class="token" style="color:#a9b7c6">,</span>
  __items<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6897bb">5</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6897bb">1</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6897bb">4</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">,</span>
  __someVeryVeryPrivateAndUglyName<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#cc7832">true</span>
<span class="token" style="color:#a9b7c6">}</span>
</code></pre></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">4.</span> <!-- -->Parting words</h2></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">4.1.</span> <!-- -->Yes, optimizing JavaScript is hard.</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">4.2.</span> <!-- -->But it does not mean we cannot do it.</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">4.3.</span> <!-- -->Most tips are applicable to every high-level languages.</h3></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">4.4.</span> <!-- -->But JavaScript has its idiosyncrasies</h3><p class="sc-kkGfuU kPOGYN" font-size="2">The <code class="sc-brqgnP gsyCmg" color="code">ByteArray</code> tips absolutely don&#x27;t work in python.</p><p class="sc-kkGfuU kPOGYN" font-size="2">It&#x27;s even slower if you use <code class="sc-brqgnP gsyCmg" color="code">numpy</code> arrays. (you need to go full native).</p></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix"></span> <!-- -->The gist</h3><p class="sc-kkGfuU kPOGYN" font-size="2">To be efficient your code must be <strong>statically interpretable</strong>.</p><p class="sc-kkGfuU kPOGYN" font-size="2">If you do that:</p><ol class="sc-hSdWYo fJODMz" font-size="2"><li class="sc-eHgmQL gmKbQu">The engine will have <strong>no hard decisions</strong> to make</li><li class="sc-eHgmQL gmKbQu">And will safely choose the most aggressive optimization paths</li></ol></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix"></span> <!-- -->Rephrased</h3><p class="sc-kkGfuU kPOGYN" font-size="2">Optimizing JavaScript = squinting a little and <strong>pretending</strong> really hard that:</p><ol class="sc-hSdWYo fJODMz" font-size="2"><li class="sc-eHgmQL gmKbQu">The language has static typing.</li><li class="sc-eHgmQL gmKbQu">That the language is low-level.</li></ol></div></div><div class="sc-htoDjs zIEGn"><div><h3 class="sc-jhAzac hmXDXQ sc-hzDkRC gaOIFD" font-size="2" color="heading"><span class="affix">4.5.</span> <!-- -->Associative arrays are the next frontier</h3><p class="sc-kkGfuU kPOGYN" font-size="2">For now, there is no way to beat JavaScript&#x27;s objects and maps when doing key-value association.</p><p class="sc-kkGfuU kPOGYN" font-size="2"><em>Yet...</em></p></div></div><div class="sc-htoDjs zIEGn"><div><h2 class="sc-bRBYWo ccSRck sc-Rmtcm bQMXUX" font-size="3" color="heading"><span class="affix">5.</span> <!-- -->References</h2><p class="sc-kkGfuU kPOGYN" font-size="2">Examples were taken from the following libraries:</p><ul class="sc-iAyFgw iLvMQI" font-size="2"><li class="sc-eHgmQL gmKbQu"><a class="sc-kEYyzF RNNXF" href="https://yomguithereal.github.io/mnemonist" color="link">mnemonist</a>: <small><em>yomguithereal.github.io/mnemonist</em></small></li><li class="sc-eHgmQL gmKbQu"><a class="sc-kEYyzF RNNXF" href="https://graphology.github.io" color="link">graphology</a>: <small><em>graphology.github.io</em></small></li><li class="sc-eHgmQL gmKbQu"><a class="sc-kEYyzF RNNXF" href="http://sigmajs.org" color="link">sigma.js</a>: <small><em>sigmajs.org</em></small></li></ul></div></div><div class="sc-htoDjs zIEGn"><div><h1 class="sc-cSHVUG CAuLq sc-jzJRlG hLseSp" font-size="4" color="heading">Thanks!</h1></div></div></div></div></div></div><div class="sc-htpNat cXgiMa"><div class="sc-bdVaJa eCoqJu"><button class="sc-bwzfXH gNzbUH" title="go to: 0" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 1" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 2" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 3" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 4" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 5" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 6" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 7" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 8" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 9" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 10" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 11" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 12" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 13" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 14" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 15" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 16" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 17" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 18" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 19" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 20" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 21" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 22" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 23" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 24" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 25" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 26" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 27" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 28" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 29" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 30" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 31" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 32" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 33" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 34" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 35" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 36" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 37" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 38" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 39" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 40" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 41" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 42" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 43" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 44" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 45" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 46" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 47" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 48" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 49" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 50" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 51" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 52" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 53" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 54" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 55" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 56" color="text"></button><button class="sc-bwzfXH jQkfWF" title="go to: 57" color="text"></button></div></div><div class="sc-ifAKCX hOCGEu sc-bxivhb fbxTAJ" role="button" title="Previous Slide"></div><div class="sc-EHOje bNhvRs sc-bxivhb fbxTAJ" role="button" title="Next Slide"></div></div>
<script src="main.js"></script>
</body>
</html>
